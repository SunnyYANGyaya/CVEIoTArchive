---
created: 2025-09-11T01:09:53 (UTC +08:00)
tags: []
source: https://github.com/WhereisDoujo/CVE/issues/7
author: WhereisDoujo
---

# TP-Link TL-WR940N v4 firmware has a buffer overflow vulnerability at function sub_44E6E0 · Issue #7 · WhereisDoujo/CVE

> ## Excerpt
> Vendor of the products: TP-Link Affected products: TL-WR940N V4 Hardware Link：https://www.tp-link.com/en/support/download/tl-wr940n/v4/#Firmware Vulnerability Description A buffer overflow vulnerab...

---
Vendor of the products:　TP-Link

Affected products:　TL-WR940N V4

Hardware Link：[https://www.tp-link.com/en/support/download/tl-wr940n/v4/#Firmware](https://www.tp-link.com/en/support/download/tl-wr940n/v4/#Firmware)

## Vulnerability Description

A buffer overflow vulnerability was discovered in TP-Link TL-WR940N V4, triggered by the dnsserver1 parameter at /userRpm/WanSlaacCfgRpm.htm. This vulnerability allows attackers to cause a Denial of Service (DoS) via a crafted packet.

Vulnerability trigger interface

[![Image](TP-Link%20TL-WR940N%20v4%20firmware%20has%20a%20buffer%20overflow%20vulnerability%20at%20function%20sub_44E6E0%20%C2%B7%20Issue%207%20%C2%B7%20WhereisDoujoCVE/452890171-3ac627d3-97bd-4e01-9ce0-104b6019bc39.png)](https://private-user-images.githubusercontent.com/123819633/452890171-3ac627d3-97bd-4e01-9ce0-104b6019bc39.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NTc1MjQ0NjksIm5iZiI6MTc1NzUyNDE2OSwicGF0aCI6Ii8xMjM4MTk2MzMvNDUyODkwMTcxLTNhYzYyN2QzLTk3YmQtNGUwMS05Y2UwLTEwNGI2MDE5YmMzOS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwOTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDkxMFQxNzA5MjlaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1jNjFiNjg1OTg2OGMxYmM4YWJhMjYyNjkwMDdkZGZiN2Q2ZWEwN2M4NmEwMjBlODNmZGY3NTNlYWIxZGQ0NWM4JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.bUfhtW6HvxvNGCn4S0OIAOSzV0MoTpcjoLAWQ_Lsy5c)

## POC

send

[![Image](TP-Link%20TL-WR940N%20v4%20firmware%20has%20a%20buffer%20overflow%20vulnerability%20at%20function%20sub_44E6E0%20%C2%B7%20Issue%207%20%C2%B7%20WhereisDoujoCVE/447510602-371e597c-a758-422a-b613-05e06f0be64a.png)](https://private-user-images.githubusercontent.com/123819633/447510602-371e597c-a758-422a-b613-05e06f0be64a.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NTc1MjQ0NjksIm5iZiI6MTc1NzUyNDE2OSwicGF0aCI6Ii8xMjM4MTk2MzMvNDQ3NTEwNjAyLTM3MWU1OTdjLWE3NTgtNDIyYS1iNjEzLTA1ZTA2ZjBiZTY0YS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwOTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDkxMFQxNzA5MjlaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT02NzkxZDdjYTgyZjc0MmQ2Njc5MWFmZWFhNWMwYzczNWVmMTEyMTcxMGZkNjY1MzA4ZDk1MjA3NGFhYTJjZDU2JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.iUZ0VLowuuJXnlckbO_NUJ4-PqmaSX4tjm68ZqYvvqw)

You can see that the router has crashed.

[![Image](TP-Link%20TL-WR940N%20v4%20firmware%20has%20a%20buffer%20overflow%20vulnerability%20at%20function%20sub_44E6E0%20%C2%B7%20Issue%207%20%C2%B7%20WhereisDoujoCVE/447510823-49261b72-4e67-4396-9f4a-68c956eab454.png)](https://private-user-images.githubusercontent.com/123819633/447510823-49261b72-4e67-4396-9f4a-68c956eab454.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NTc1MjQ0NjksIm5iZiI6MTc1NzUyNDE2OSwicGF0aCI6Ii8xMjM4MTk2MzMvNDQ3NTEwODIzLTQ5MjYxYjcyLTRlNjctNDM5Ni05ZjRhLTY4Yzk1NmVhYjQ1NC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwOTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDkxMFQxNzA5MjlaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1hMjc5MDE0N2E0ZGYxYTI3NzY5NDczYmRmNGY2M2EzOWNiMjVmZGFmZTIzZmQyMTcyNjRkZjA2MmNhYzRmMzQ5JlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.OgWeO7AZPOdZkIpSPhZ2pXUwnYOfZ3Xq6VUvD3hZpTw)

The router can't be accessed normally either.

[![Image](TP-Link%20TL-WR940N%20v4%20firmware%20has%20a%20buffer%20overflow%20vulnerability%20at%20function%20sub_44E6E0%20%C2%B7%20Issue%207%20%C2%B7%20WhereisDoujoCVE/447510916-132e054a-40e5-4f75-9146-3305a42127c5.png)](https://private-user-images.githubusercontent.com/123819633/447510916-132e054a-40e5-4f75-9146-3305a42127c5.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NTc1MjQ0NjksIm5iZiI6MTc1NzUyNDE2OSwicGF0aCI6Ii8xMjM4MTk2MzMvNDQ3NTEwOTE2LTEzMmUwNTRhLTQwZTUtNGY3NS05MTQ2LTMzMDVhNDIxMjdjNS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwOTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDkxMFQxNzA5MjlaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT05NTg0Njg0MWIxMGY5ZmQ3MmUzNzc3YmYwZTNhOWJkY2M5ZWMwYjc5MmY0MGRlNTlmNTI2OTdkODg0NjE3ZmNmJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.SLEOzYQIYHRgp9tYsY9i7oTxSHZDM6tLJzo4rqz44po)

## Code in httpd

By using IDA to analyze httpd, in the function sub\_44E6E0, the program first calls httpGetEnv to retrieve the dnsserver1 parameter.

[![Image](TP-Link%20TL-WR940N%20v4%20firmware%20has%20a%20buffer%20overflow%20vulnerability%20at%20function%20sub_44E6E0%20%C2%B7%20Issue%207%20%C2%B7%20WhereisDoujoCVE/447510973-5f0c1696-5df7-454a-9a02-048f38f0633d.png)](https://private-user-images.githubusercontent.com/123819633/447510973-5f0c1696-5df7-454a-9a02-048f38f0633d.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NTc1MjQ0NjksIm5iZiI6MTc1NzUyNDE2OSwicGF0aCI6Ii8xMjM4MTk2MzMvNDQ3NTEwOTczLTVmMGMxNjk2LTVkZjctNDU0YS05YTAyLTA0OGYzOGYwNjMzZC5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwOTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDkxMFQxNzA5MjlaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT1kMGUwYmZhYTAzY2ZhNWI4OTM3ZDA0ZDE0N2RiYjc0NjY0M2Y3YjQ4ODQ3NzA5YWZiNjYwY2YxNjlmMzU4MjQyJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.LowQSZRD1DUywiZq2wGCH30Oi3KjLOY6i91IEn3eI9k)

The parameters are then passed to the strcpy function without proper security checks, leading to a buffer overflow.

[![Image](TP-Link%20TL-WR940N%20v4%20firmware%20has%20a%20buffer%20overflow%20vulnerability%20at%20function%20sub_44E6E0%20%C2%B7%20Issue%207%20%C2%B7%20WhereisDoujoCVE/447510998-777813aa-022a-42d3-96cc-88a816b1e36e.png)](https://private-user-images.githubusercontent.com/123819633/447510998-777813aa-022a-42d3-96cc-88a816b1e36e.png?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3NTc1MjQ0NjksIm5iZiI6MTc1NzUyNDE2OSwicGF0aCI6Ii8xMjM4MTk2MzMvNDQ3NTEwOTk4LTc3NzgxM2FhLTAyMmEtNDJkMy05NmNjLTg4YTgxNmIxZTM2ZS5wbmc_WC1BbXotQWxnb3JpdGhtPUFXUzQtSE1BQy1TSEEyNTYmWC1BbXotQ3JlZGVudGlhbD1BS0lBVkNPRFlMU0E1M1BRSzRaQSUyRjIwMjUwOTEwJTJGdXMtZWFzdC0xJTJGczMlMkZhd3M0X3JlcXVlc3QmWC1BbXotRGF0ZT0yMDI1MDkxMFQxNzA5MjlaJlgtQW16LUV4cGlyZXM9MzAwJlgtQW16LVNpZ25hdHVyZT0xYmVlN2VmZjhkMjg4YjhmMGMwNTY2OGQ3YWU0ZThlZmZlNmM0ZWIzM2MyNjM3MDQwODhmNWRhMTYzYjUxYzVkJlgtQW16LVNpZ25lZEhlYWRlcnM9aG9zdCJ9.j_sfVECQ-M3wNqiCH2DkBa9P1IBTZJyuos9rW5JlsVQ)
